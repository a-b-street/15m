var ve=Object.defineProperty;var Se=(p,h,A)=>h in p?ve(p,h,{enumerable:!0,configurable:!0,writable:!0,value:A}):p[h]=A;var te=(p,h,A)=>(Se(p,typeof h!="symbol"?h+"":h,A),A);(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p=Symbol("Comlink.proxy"),h=Symbol("Comlink.endpoint"),A=Symbol("Comlink.releaseProxy"),D=Symbol("Comlink.finalizer"),j=Symbol("Comlink.thrown"),G=n=>typeof n=="object"&&n!==null||typeof n=="function",re={canHandle:n=>G(n)&&n[p],serialize(n){const{port1:e,port2:t}=new MessageChannel;return U(n,e),[t,[t]]},deserialize(n){return n.start(),ae(n)}},oe={canHandle:n=>G(n)&&j in n,serialize({value:n}){let e;return n instanceof Error?e={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:e={isError:!1,value:n},[e,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},Y=new Map([["proxy",re],["throw",oe]]);function ie(n,e){for(const t of n)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function U(n,e=globalThis,t=["*"]){e.addEventListener("message",function r(o){if(!o||!o.data)return;if(!ie(t,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}const{id:d,type:a,path:_}=Object.assign({path:[]},o.data),u=(o.data.argumentList||[]).map(v);let c;try{const l=_.slice(0,-1).reduce((w,N)=>w[N],n),b=_.reduce((w,N)=>w[N],n);switch(a){case"GET":c=b;break;case"SET":l[_.slice(-1)[0]]=v(o.data.value),c=!0;break;case"APPLY":c=b.apply(l,u);break;case"CONSTRUCT":{const w=new b(...u);c=de(w)}break;case"ENDPOINT":{const{port1:w,port2:N}=new MessageChannel;U(n,N),c=fe(w,[w])}break;case"RELEASE":c=void 0;break;default:return}}catch(l){c={value:l,[j]:0}}Promise.resolve(c).catch(l=>({value:l,[j]:0})).then(l=>{const[b,w]=W(l);e.postMessage(Object.assign(Object.assign({},b),{id:d}),w),a==="RELEASE"&&(e.removeEventListener("message",r),K(e),D in n&&typeof n[D]=="function"&&n[D]())}).catch(l=>{const[b,w]=W({value:new TypeError("Unserializable return value"),[j]:0});e.postMessage(Object.assign(Object.assign({},b),{id:d}),w)})}),e.start&&e.start()}function se(n){return n.constructor.name==="MessagePort"}function K(n){se(n)&&n.close()}function ae(n,e){return H(n,[],e)}function F(n){if(n)throw new Error("Proxy has been released and is not useable")}function X(n){return T(n,{type:"RELEASE"}).then(()=>{K(n)})}const P=new WeakMap,C="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{const e=(P.get(n)||0)-1;P.set(n,e),e===0&&X(n)});function ce(n,e){const t=(P.get(e)||0)+1;P.set(e,t),C&&C.register(n,e,n)}function _e(n){C&&C.unregister(n)}function H(n,e=[],t=function(){}){let r=!1;const o=new Proxy(t,{get(d,a){if(F(r),a===A)return()=>{_e(o),X(n),r=!0};if(a==="then"){if(e.length===0)return{then:()=>o};const _=T(n,{type:"GET",path:e.map(u=>u.toString())}).then(v);return _.then.bind(_)}return H(n,[...e,a])},set(d,a,_){F(r);const[u,c]=W(_);return T(n,{type:"SET",path:[...e,a].map(l=>l.toString()),value:u},c).then(v)},apply(d,a,_){F(r);const u=e[e.length-1];if(u===h)return T(n,{type:"ENDPOINT"}).then(v);if(u==="bind")return H(n,e.slice(0,-1));const[c,l]=Q(_);return T(n,{type:"APPLY",path:e.map(b=>b.toString()),argumentList:c},l).then(v)},construct(d,a){F(r);const[_,u]=Q(a);return T(n,{type:"CONSTRUCT",path:e.map(c=>c.toString()),argumentList:_},u).then(v)}});return ce(o,n),o}function ue(n){return Array.prototype.concat.apply([],n)}function Q(n){const e=n.map(W);return[e.map(t=>t[0]),ue(e.map(t=>t[1]))]}const Z=new WeakMap;function fe(n,e){return Z.set(n,e),n}function de(n){return Object.assign(n,{[p]:!0})}function W(n){for(const[e,t]of Y)if(t.canHandle(n)){const[r,o]=t.serialize(n);return[{type:"HANDLER",name:e,value:r},o]}return[{type:"RAW",value:n},Z.get(n)||[]]}function v(n){switch(n.type){case"HANDLER":return Y.get(n.name).deserialize(n.value);case"RAW":return n.value}}function T(n,e,t){return new Promise(r=>{const o=ge();n.addEventListener("message",function d(a){!a.data||!a.data.id||a.data.id!==o||(n.removeEventListener("message",d),r(a.data))}),n.start&&n.start(),n.postMessage(Object.assign({id:o},e),t)})}function ge(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}let i;const m=new Array(128).fill(void 0);m.push(void 0,null,!0,!1);function s(n){return m[n]}let M=m.length;function le(n){n<132||(m[n]=M,M=n)}function E(n){const e=s(n);return le(n),e}let S=0,O=null;function R(){return(O===null||O.byteLength===0)&&(O=new Uint8Array(i.memory.buffer)),O}const z=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},be=typeof z.encodeInto=="function"?function(n,e){return z.encodeInto(n,e)}:function(n,e){const t=z.encode(n);return e.set(t),{read:n.length,written:t.length}};function V(n,e,t){if(t===void 0){const _=z.encode(n),u=e(_.length,1)>>>0;return R().subarray(u,u+_.length).set(_),S=_.length,u}let r=n.length,o=e(r,1)>>>0;const d=R();let a=0;for(;a<r;a++){const _=n.charCodeAt(a);if(_>127)break;d[o+a]=_}if(a!==r){a!==0&&(n=n.slice(a)),o=t(o,r,r=a+n.length*3,1)>>>0;const _=R().subarray(o+a,o+r),u=be(n,_);a+=u.written,o=t(o,r,a,1)>>>0}return S=a,o}function x(n){return n==null}let B=null;function f(){return(B===null||B.byteLength===0)&&(B=new Int32Array(i.memory.buffer)),B}let I=null;function q(){return(I===null||I.byteLength===0)&&(I=new Float64Array(i.memory.buffer)),I}function g(n){M===m.length&&m.push(m.length+1);const e=M;return M=m[e],m[e]=n,e}const ee=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&ee.decode();function y(n,e){return n=n>>>0,ee.decode(R().subarray(n,n+e))}let L=null;function we(){return(L===null||L.byteLength===0)&&(L=new BigInt64Array(i.memory.buffer)),L}function $(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const o=n.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=n.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(n)){const o=n.length;let d="[";o>0&&(d+=$(n[0]));for(let a=1;a<o;a++)d+=", "+$(n[a]);return d+="]",d}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(t.length>1)r=t[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function ye(n,e){const t=e(n.length*1,1)>>>0;return R().set(n,t/1),S=n.length,t}function he(n,e){return n=n>>>0,q().subarray(n/8,n/8+e)}function k(n,e){try{return n.apply(this,e)}catch(t){i.__wbindgen_exn_store(g(t))}}const me=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>i.__wbg_mapmodel_free(n>>>0));class ne{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,me.unregister(this),e}free(){const e=this.__destroy_into_raw();i.__wbg_mapmodel_free(e)}constructor(e,t,r){try{const _=i.__wbindgen_add_to_stack_pointer(-16),u=ye(e,i.__wbindgen_malloc),c=S;i.mapmodel_new(_,u,c,t,x(r)?0:g(r));var o=f()[_/4+0],d=f()[_/4+1],a=f()[_/4+2];if(a)throw E(d);return this.__wbg_ptr=o>>>0,this}finally{i.__wbindgen_add_to_stack_pointer(16)}}renderDebug(){let e,t;try{const c=i.__wbindgen_add_to_stack_pointer(-16);i.mapmodel_renderDebug(c,this.__wbg_ptr);var r=f()[c/4+0],o=f()[c/4+1],d=f()[c/4+2],a=f()[c/4+3],_=r,u=o;if(a)throw _=0,u=0,E(d);return e=_,t=u,y(_,u)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_free(e,t,1)}}renderAmenities(){let e,t;try{const c=i.__wbindgen_add_to_stack_pointer(-16);i.mapmodel_renderAmenities(c,this.__wbg_ptr);var r=f()[c/4+0],o=f()[c/4+1],d=f()[c/4+2],a=f()[c/4+3],_=r,u=o;if(a)throw _=0,u=0,E(d);return e=_,t=u,y(_,u)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_free(e,t,1)}}getInvertedBoundary(){let e,t;try{const c=i.__wbindgen_add_to_stack_pointer(-16);i.mapmodel_getInvertedBoundary(c,this.__wbg_ptr);var r=f()[c/4+0],o=f()[c/4+1],d=f()[c/4+2],a=f()[c/4+3],_=r,u=o;if(a)throw _=0,u=0,E(d);return e=_,t=u,y(_,u)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_free(e,t,1)}}getBounds(){try{const o=i.__wbindgen_add_to_stack_pointer(-16);i.mapmodel_getBounds(o,this.__wbg_ptr);var e=f()[o/4+0],t=f()[o/4+1],r=he(e,t).slice();return i.__wbindgen_free(e,t*8,8),r}finally{i.__wbindgen_add_to_stack_pointer(16)}}isochrone(e){let t,r;try{const l=i.__wbindgen_add_to_stack_pointer(-16);i.mapmodel_isochrone(l,this.__wbg_ptr,g(e));var o=f()[l/4+0],d=f()[l/4+1],a=f()[l/4+2],_=f()[l/4+3],u=o,c=d;if(_)throw u=0,c=0,E(a);return t=u,r=c,y(u,c)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_free(t,r,1)}}route(e){let t,r;try{const l=i.__wbindgen_add_to_stack_pointer(-16);i.mapmodel_route(l,this.__wbg_ptr,g(e));var o=f()[l/4+0],d=f()[l/4+1],a=f()[l/4+2],_=f()[l/4+3],u=o,c=d;if(_)throw u=0,c=0,E(a);return t=u,r=c,y(u,c)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_free(t,r,1)}}score(e,t){let r,o;try{const b=i.__wbindgen_add_to_stack_pointer(-16);i.mapmodel_score(b,this.__wbg_ptr,g(e),x(t)?0:g(t));var d=f()[b/4+0],a=f()[b/4+1],_=f()[b/4+2],u=f()[b/4+3],c=d,l=a;if(u)throw c=0,l=0,E(_);return r=c,o=l,y(c,l)}finally{i.__wbindgen_add_to_stack_pointer(16),i.__wbindgen_free(r,o,1)}}}async function pe(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function Ee(){const n={};return n.wbg={},n.wbg.__wbindgen_object_drop_ref=function(e){E(e)},n.wbg.__wbindgen_string_get=function(e,t){const r=s(t),o=typeof r=="string"?r:void 0;var d=x(o)?0:V(o,i.__wbindgen_malloc,i.__wbindgen_realloc),a=S;f()[e/4+1]=a,f()[e/4+0]=d},n.wbg.__wbindgen_boolean_get=function(e){const t=s(e);return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_is_object=function(e){const t=s(e);return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return s(e)===void 0},n.wbg.__wbindgen_in=function(e,t){return s(e)in s(t)},n.wbg.__wbindgen_number_get=function(e,t){const r=s(t),o=typeof r=="number"?r:void 0;q()[e/8+1]=x(o)?0:o,f()[e/4+0]=!x(o)},n.wbg.__wbindgen_is_bigint=function(e){return typeof s(e)=="bigint"},n.wbg.__wbindgen_bigint_from_u64=function(e){const t=BigInt.asUintN(64,e);return g(t)},n.wbg.__wbindgen_jsval_eq=function(e,t){return s(e)===s(t)},n.wbg.__wbindgen_error_new=function(e,t){const r=new Error(y(e,t));return g(r)},n.wbg.__wbindgen_string_new=function(e,t){const r=y(e,t);return g(r)},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return s(e)==s(t)},n.wbg.__wbindgen_object_clone_ref=function(e){const t=s(e);return g(t)},n.wbg.__wbg_getwithrefkey_3b3c46ba20582127=function(e,t){const r=s(e)[s(t)];return g(r)},n.wbg.__wbg_debug_34c9290896ec9856=function(e){console.debug(s(e))},n.wbg.__wbg_error_e60eff06f24ab7a4=function(e){console.error(s(e))},n.wbg.__wbg_info_d7d58472d0bab115=function(e){console.info(s(e))},n.wbg.__wbg_log_a4530b4fe289336f=function(e){console.log(s(e))},n.wbg.__wbg_warn_f260f49434e45e62=function(e){console.warn(s(e))},n.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return g(e)},n.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const r=s(t).stack,o=V(r,i.__wbindgen_malloc,i.__wbindgen_realloc),d=S;f()[e/4+1]=d,f()[e/4+0]=o},n.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let r,o;try{r=e,o=t,console.error(y(e,t))}finally{i.__wbindgen_free(r,o,1)}},n.wbg.__wbg_performance_a1b8bde2ee512264=function(e){const t=s(e).performance;return g(t)},n.wbg.__wbg_now_abd80e969af37148=function(e){return s(e).now()},n.wbg.__wbg_get_bd8e338fbd5f5cc8=function(e,t){const r=s(e)[t>>>0];return g(r)},n.wbg.__wbg_length_cd7af8117672b8b8=function(e){return s(e).length},n.wbg.__wbindgen_is_function=function(e){return typeof s(e)=="function"},n.wbg.__wbg_newnoargs_e258087cd0daa0ea=function(e,t){const r=new Function(y(e,t));return g(r)},n.wbg.__wbg_next_40fc327bfc8770e6=function(e){const t=s(e).next;return g(t)},n.wbg.__wbg_next_196c84450b364254=function(){return k(function(e){const t=s(e).next();return g(t)},arguments)},n.wbg.__wbg_done_298b57d23c0fc80c=function(e){return s(e).done},n.wbg.__wbg_value_d93c65011f51a456=function(e){const t=s(e).value;return g(t)},n.wbg.__wbg_iterator_2cee6dadfd956dfa=function(){return g(Symbol.iterator)},n.wbg.__wbg_get_e3c254076557e348=function(){return k(function(e,t){const r=Reflect.get(s(e),s(t));return g(r)},arguments)},n.wbg.__wbg_call_27c0f87801dedf93=function(){return k(function(e,t){const r=s(e).call(s(t));return g(r)},arguments)},n.wbg.__wbg_self_ce0dbfc45cf2f5be=function(){return k(function(){const e=self.self;return g(e)},arguments)},n.wbg.__wbg_window_c6fb939a7f436783=function(){return k(function(){const e=window.window;return g(e)},arguments)},n.wbg.__wbg_globalThis_d1e6af4856ba331b=function(){return k(function(){const e=globalThis.globalThis;return g(e)},arguments)},n.wbg.__wbg_global_207b558942527489=function(){return k(function(){const e=global.global;return g(e)},arguments)},n.wbg.__wbg_isArray_2ab64d95e09ea0ae=function(e){return Array.isArray(s(e))},n.wbg.__wbg_instanceof_ArrayBuffer_836825be07d4c9d2=function(e){let t;try{t=s(e)instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_call_b3ca7c6051f9bec1=function(){return k(function(e,t,r){const o=s(e).call(s(t),s(r));return g(o)},arguments)},n.wbg.__wbg_isSafeInteger_f7b04ef02296c4d2=function(e){return Number.isSafeInteger(s(e))},n.wbg.__wbg_buffer_12d079cc21e14bdb=function(e){const t=s(e).buffer;return g(t)},n.wbg.__wbg_new_63b92bc8671ed464=function(e){const t=new Uint8Array(s(e));return g(t)},n.wbg.__wbg_set_a47bac70306a19a7=function(e,t,r){s(e).set(s(t),r>>>0)},n.wbg.__wbg_length_c20a40f15020d68a=function(e){return s(e).length},n.wbg.__wbg_instanceof_Uint8Array_2b3bbecd033d19f6=function(e){let t;try{t=s(e)instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbindgen_bigint_get_as_i64=function(e,t){const r=s(t),o=typeof r=="bigint"?r:void 0;we()[e/8+1]=x(o)?BigInt(0):o,f()[e/4+0]=!x(o)},n.wbg.__wbindgen_debug_string=function(e,t){const r=$(s(t)),o=V(r,i.__wbindgen_malloc,i.__wbindgen_realloc),d=S;f()[e/4+1]=d,f()[e/4+0]=o},n.wbg.__wbindgen_throw=function(e,t){throw new Error(y(e,t))},n.wbg.__wbindgen_memory=function(){const e=i.memory;return g(e)},n}function ke(n,e){return i=n.exports,J.__wbindgen_wasm_module=e,L=null,I=null,B=null,O=null,i}async function J(n){if(i!==void 0)return i;typeof n>"u"&&(n="/15m/assets/backend_bg.wasm");const e=Ee();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:r}=await pe(await n,e);return ke(t,r)}class Ae{constructor(){te(this,"inner");this.inner=null}async loadOsmFile(e,t){await J(),this.inner=new ne(e,!0,t)}async loadGraphFile(e){await J(),this.inner=new ne(e,!1,void 0)}isLoaded(){return this.inner!=null}unset(){this.inner=null}getBounds(){if(!this.inner)throw new Error("Backend used without a file loaded");return Array.from(this.inner.getBounds())}getInvertedBoundary(){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.getInvertedBoundary())}renderDebug(){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.renderDebug())}renderAmenities(){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.renderAmenities())}isochrone(e){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.isochrone({x:e.start.lng,y:e.start.lat,mode:e.mode,contours:e.contours,start_time:e.startTime}))}route(e){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.route({x1:e.start.lng,y1:e.start.lat,x2:e.end[0],y2:e.end[1],mode:e.mode,debug_search:e.debugSearch,use_heuristic:e.useHeuristic,start_time:e.startTime}))}score(e,t){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.score({poi_kinds:e.poiKinds,max_seconds:e.maxSeconds},t))}}U(Ae)})();
