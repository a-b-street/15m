var Fe=Object.defineProperty;var ve=(s,f,E)=>f in s?Fe(s,f,{enumerable:!0,configurable:!0,writable:!0,value:E}):s[f]=E;var ee=(s,f,E)=>(ve(s,typeof f!="symbol"?f+"":f,E),E);(function(){"use strict";let s;function f(t){const e=s.__externref_table_alloc();return s.__wbindgen_externrefs.set(e,t),e}const E=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>t.dtor(t.a,t.b));function C(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const o=t.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=t.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(t)){const o=t.length;let i="[";o>0&&(i+=C(t[0]));for(let _=1;_<o;_++)i+=", "+C(t[_]);return i+="]",i}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n&&n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function te(t,e){return t=t>>>0,ne().subarray(t/8,t/8+e)}function W(t,e){return t=t>>>0,x().subarray(t/1,t/1+e)}let S=null;function l(){return(S===null||S.buffer.detached===!0||S.buffer.detached===void 0&&S.buffer!==s.memory.buffer)&&(S=new DataView(s.memory.buffer)),S}let F=null;function ne(){return(F===null||F.byteLength===0)&&(F=new Float64Array(s.memory.buffer)),F}function u(t,e){return t=t>>>0,ie(t,e)}let v=null;function x(){return(v===null||v.byteLength===0)&&(v=new Uint8Array(s.memory.buffer)),v}function d(t,e){try{return t.apply(this,e)}catch(n){const r=f(n);s.__wbindgen_exn_store(r)}}function b(t){return t==null}function re(t,e,n,r){const o={a:t,b:e,cnt:1,dtor:n},i=(..._)=>{o.cnt++;const c=o.a;o.a=0;try{return r(c,o.b,..._)}finally{o.a=c,i._wbg_cb_unref()}};return i._wbg_cb_unref=()=>{--o.cnt===0&&(o.dtor(o.a,o.b),o.a=0,E.unregister(o))},E.register(i,o,o),i}function V(t,e){const n=e(t.length*1,1)>>>0;return x().set(t,n/1),m=t.length,n}function k(t,e,n){if(n===void 0){const c=T.encode(t),a=e(c.length,1)>>>0;return x().subarray(a,a+c.length).set(c),m=c.length,a}let r=t.length,o=e(r,1)>>>0;const i=x();let _=0;for(;_<r;_++){const c=t.charCodeAt(_);if(c>127)break;i[o+_]=c}if(_!==r){_!==0&&(t=t.slice(_)),o=n(o,r,r=_+t.length*3,1)>>>0;const c=x().subarray(o+_,o+r),a=T.encodeInto(t,c);_+=a.written,o=n(o,r,_,1)>>>0}return m=_,o}function h(t){const e=s.__wbindgen_externrefs.get(t);return s.__externref_table_dealloc(t),e}let M=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});M.decode();const oe=2146435072;let j=0;function ie(t,e){return j+=e,j>=oe&&(M=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),M.decode(),j=e),M.decode(x().subarray(t,t+e))}const T=new TextEncoder;"encodeInto"in T||(T.encodeInto=function(t,e){const n=T.encode(t);return e.set(n),{read:t.length,written:n.length}});let m=0;function se(t,e,n){s.wasm_bindgen__convert__closures_____invoke__h973f8fb562ff39d0(t,e,n)}function _e(t,e,n,r){s.wasm_bindgen__convert__closures_____invoke__h2d7037e864ecde8d(t,e,n,r)}const ce=["omit","same-origin","include"],ae=["same-origin","no-cors","cors","navigate"];typeof FinalizationRegistry>"u"||new FinalizationRegistry(t=>s.__wbg_intounderlyingbytesource_free(t>>>0,1)),typeof FinalizationRegistry>"u"||new FinalizationRegistry(t=>s.__wbg_intounderlyingsink_free(t>>>0,1)),typeof FinalizationRegistry>"u"||new FinalizationRegistry(t=>s.__wbg_intounderlyingsource_free(t>>>0,1));const $=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_mapmodel_free(t>>>0,1));class A{static __wrap(e){e=e>>>0;const n=Object.create(A.prototype);return n.__wbg_ptr=e,$.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,$.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_mapmodel_free(e,0)}getBounds(){const e=s.mapmodel_getBounds(this.__wbg_ptr);var n=te(e[0],e[1]).slice();return s.__wbindgen_free(e[0],e[1]*8,8),n}bufferRoute(e){let n,r;try{const _=s.mapmodel_bufferRoute(this.__wbg_ptr,e);var o=_[0],i=_[1];if(_[3])throw o=0,i=0,h(_[2]);return n=o,r=i,u(o,i)}finally{s.__wbindgen_free(n,r,1)}}renderDebug(){let e,n;try{const i=s.mapmodel_renderDebug(this.__wbg_ptr);var r=i[0],o=i[1];if(i[3])throw r=0,o=0,h(i[2]);return e=r,n=o,u(r,o)}finally{s.__wbindgen_free(e,n,1)}}renderZones(){let e,n;try{const i=s.mapmodel_renderZones(this.__wbg_ptr);var r=i[0],o=i[1];if(i[3])throw r=0,o=0,h(i[2]);return e=r,n=o,u(r,o)}finally{s.__wbindgen_free(e,n,1)}}renderAmenities(){let e,n;try{const i=s.mapmodel_renderAmenities(this.__wbg_ptr);var r=i[0],o=i[1];if(i[3])throw r=0,o=0,h(i[2]);return e=r,n=o,u(r,o)}finally{s.__wbindgen_free(e,n,1)}}getInvertedBoundary(){let e,n;try{const i=s.mapmodel_getInvertedBoundary(this.__wbg_ptr);var r=i[0],o=i[1];if(i[3])throw r=0,o=0,h(i[2]);return e=r,n=o,u(r,o)}finally{s.__wbindgen_free(e,n,1)}}snapAndBufferRoute(e,n){let r,o;try{const c=s.mapmodel_snapAndBufferRoute(this.__wbg_ptr,e,b(n)?0:f(n));var i=c[0],_=c[1];if(c[3])throw i=0,_=0,h(c[2]);return r=i,o=_,u(i,_)}finally{s.__wbindgen_free(r,o,1)}}constructor(e,n,r,o){const i=V(e,s.__wbindgen_malloc),_=m;var c=b(n)?0:k(n,s.__wbindgen_malloc,s.__wbindgen_realloc),a=m,g=b(r)?0:k(r,s.__wbindgen_malloc,s.__wbindgen_realloc),w=m;return s.mapmodel_new(i,_,c,a,g,w,b(o)?0:f(o))}route(e){let n,r;try{const _=s.mapmodel_route(this.__wbg_ptr,e);var o=_[0],i=_[1];if(_[3])throw o=0,i=0,h(_[2]);return n=o,r=i,u(o,i)}finally{s.__wbindgen_free(n,r,1)}}score(e,n){let r,o;try{const c=s.mapmodel_score(this.__wbg_ptr,e,b(n)?0:f(n));var i=c[0],_=c[1];if(c[3])throw i=0,_=0,h(c[2]);return r=i,o=_,u(i,_)}finally{s.__wbindgen_free(r,o,1)}}isochrone(e){let n,r;try{const _=s.mapmodel_isochrone(this.__wbg_ptr,e);var o=_[0],i=_[1];if(_[3])throw o=0,i=0,h(_[2]);return n=o,r=i,u(o,i)}finally{s.__wbindgen_free(n,r,1)}}static loadFile(e){const n=V(e,s.__wbindgen_malloc),r=m,o=s.mapmodel_loadFile(n,r);if(o[2])throw h(o[1]);return A.__wrap(o[0])}}Symbol.dispose&&(A.prototype[Symbol.dispose]=A.prototype.free);const fe=new Set(["basic","cors","default"]);async function ue(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.ok&&fe.has(t.type)&&t.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function be(){const t={};return t.wbg={},t.wbg.__wbg_Error_52673b7de5a0ca89=function(e,n){return Error(u(e,n))},t.wbg.__wbg___wbindgen_bigint_get_as_i64_6e32f5e6aff02e1d=function(e,n){const r=n,o=typeof r=="bigint"?r:void 0;l().setBigInt64(e+8*1,b(o)?BigInt(0):o,!0),l().setInt32(e+4*0,!b(o),!0)},t.wbg.__wbg___wbindgen_boolean_get_dea25b33882b895b=function(e){const n=e,r=typeof n=="boolean"?n:void 0;return b(r)?16777215:r?1:0},t.wbg.__wbg___wbindgen_debug_string_adfb662ae34724b6=function(e,n){const r=C(n),o=k(r,s.__wbindgen_malloc,s.__wbindgen_realloc),i=m;l().setInt32(e+4*1,i,!0),l().setInt32(e+4*0,o,!0)},t.wbg.__wbg___wbindgen_in_0d3e1e8f0c669317=function(e,n){return e in n},t.wbg.__wbg___wbindgen_is_bigint_0e1a2e3f55cfae27=function(e){return typeof e=="bigint"},t.wbg.__wbg___wbindgen_is_function_8d400b8b1af978cd=function(e){return typeof e=="function"},t.wbg.__wbg___wbindgen_is_object_ce774f3490692386=function(e){const n=e;return typeof n=="object"&&n!==null},t.wbg.__wbg___wbindgen_is_undefined_f6b95eab589e0269=function(e){return e===void 0},t.wbg.__wbg___wbindgen_jsval_eq_b6101cc9cef1fe36=function(e,n){return e===n},t.wbg.__wbg___wbindgen_jsval_loose_eq_766057600fdd1b0d=function(e,n){return e==n},t.wbg.__wbg___wbindgen_number_get_9619185a74197f95=function(e,n){const r=n,o=typeof r=="number"?r:void 0;l().setFloat64(e+8*1,b(o)?0:o,!0),l().setInt32(e+4*0,!b(o),!0)},t.wbg.__wbg___wbindgen_string_get_a2a31e16edf96e42=function(e,n){const r=n,o=typeof r=="string"?r:void 0;var i=b(o)?0:k(o,s.__wbindgen_malloc,s.__wbindgen_realloc),_=m;l().setInt32(e+4*1,_,!0),l().setInt32(e+4*0,i,!0)},t.wbg.__wbg___wbindgen_throw_dd24417ed36fc46e=function(e,n){throw new Error(u(e,n))},t.wbg.__wbg__wbg_cb_unref_87dfb5aaa0cbcea7=function(e){e._wbg_cb_unref()},t.wbg.__wbg_abort_07646c894ebbf2bd=function(e){e.abort()},t.wbg.__wbg_append_c5cbdf46455cc776=function(){return d(function(e,n,r,o,i){e.append(u(n,r),u(o,i))},arguments)},t.wbg.__wbg_arrayBuffer_c04af4fce566092d=function(){return d(function(e){return e.arrayBuffer()},arguments)},t.wbg.__wbg_body_947b901c33f7fe32=function(e){const n=e.body;return b(n)?0:f(n)},t.wbg.__wbg_buffer_6cb2fecb1f253d71=function(e){return e.buffer},t.wbg.__wbg_byobRequest_f8e3517f5f8ad284=function(e){const n=e.byobRequest;return b(n)?0:f(n)},t.wbg.__wbg_byteLength_faa9938885bdeee6=function(e){return e.byteLength},t.wbg.__wbg_byteOffset_3868b6a19ba01dea=function(e){return e.byteOffset},t.wbg.__wbg_call_3020136f7a2d6e44=function(){return d(function(e,n,r){return e.call(n,r)},arguments)},t.wbg.__wbg_call_abb4ff46ce38be40=function(){return d(function(e,n){return e.call(n)},arguments)},t.wbg.__wbg_cancel_a65cf45dca50ba4c=function(e){return e.cancel()},t.wbg.__wbg_catch_b9db41d97d42bd02=function(e,n){return e.catch(n)},t.wbg.__wbg_close_0af5661bf3d335f2=function(){return d(function(e){e.close()},arguments)},t.wbg.__wbg_close_3ec111e7b23d94d8=function(){return d(function(e){e.close()},arguments)},t.wbg.__wbg_debug_9d0c87ddda3dc485=function(e){console.debug(e)},t.wbg.__wbg_done_62ea16af4ce34b24=function(e){return e.done},t.wbg.__wbg_done_aa9440a9a0044677=function(e){return e.done},t.wbg.__wbg_enqueue_a7e6b1ee87963aad=function(){return d(function(e,n){e.enqueue(n)},arguments)},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,n){let r,o;try{r=e,o=n,console.error(u(e,n))}finally{s.__wbindgen_free(r,o,1)}},t.wbg.__wbg_error_7bc7d576a6aaf855=function(e){console.error(e)},t.wbg.__wbg_fetch_094979620990dda8=function(e){return fetch(e)},t.wbg.__wbg_fetch_90447c28cc0b095e=function(e,n){return e.fetch(n)},t.wbg.__wbg_fetch_f1856afdb49415d1=function(e){return fetch(e)},t.wbg.__wbg_getReader_b8da5f78e021c7b5=function(){return d(function(e){return e.getReader()},arguments)},t.wbg.__wbg_get_6b7bd52aca3f9671=function(e,n){return e[n>>>0]},t.wbg.__wbg_get_af9dab7e9603ea93=function(){return d(function(e,n){return Reflect.get(e,n)},arguments)},t.wbg.__wbg_get_with_ref_key_e9026717d2cfa473=function(e,n){return e[n]},t.wbg.__wbg_has_0e670569d65d3a45=function(){return d(function(e,n){return Reflect.has(e,n)},arguments)},t.wbg.__wbg_headers_654c30e1bcccc552=function(e){return e.headers},t.wbg.__wbg_info_ce6bcc489c22f6f0=function(e){console.info(e)},t.wbg.__wbg_instanceof_ArrayBuffer_f3320d2419cd0355=function(e){let n;try{n=e instanceof ArrayBuffer}catch{n=!1}return n},t.wbg.__wbg_instanceof_Response_cd74d1c2ac92cb0b=function(e){let n;try{n=e instanceof Response}catch{n=!1}return n},t.wbg.__wbg_instanceof_Uint8Array_da54ccc9d3e09434=function(e){let n;try{n=e instanceof Uint8Array}catch{n=!1}return n},t.wbg.__wbg_isArray_51fd9e6422c0a395=function(e){return Array.isArray(e)},t.wbg.__wbg_isSafeInteger_ae7d3f054d55fa16=function(e){return Number.isSafeInteger(e)},t.wbg.__wbg_iterator_27b7c8b35ab3e86b=function(){return Symbol.iterator},t.wbg.__wbg_length_22ac23eaec9d8053=function(e){return e.length},t.wbg.__wbg_length_d45040a40c570362=function(e){return e.length},t.wbg.__wbg_log_1d990106d99dacb7=function(e){console.log(e)},t.wbg.__wbg_mapmodel_new=function(e){return A.__wrap(e)},t.wbg.__wbg_new_1ba21ce319a06297=function(){return new Object},t.wbg.__wbg_new_3c79b3bb1b32b7d3=function(){return d(function(){return new Headers},arguments)},t.wbg.__wbg_new_6421f6084cc5bc5a=function(e){return new Uint8Array(e)},t.wbg.__wbg_new_881a222c65f168fc=function(){return d(function(){return new AbortController},arguments)},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},t.wbg.__wbg_new_df1173567d5ff028=function(e,n){return new Error(u(e,n))},t.wbg.__wbg_new_ff12d2b041fb48f1=function(e,n){try{var r={a:e,b:n},o=(_,c)=>{const a=r.a;r.a=0;try{return _e(a,r.b,_,c)}finally{r.a=a}};return new Promise(o)}finally{r.a=r.b=0}},t.wbg.__wbg_new_from_slice_f9c22b9153b26992=function(e,n){return new Uint8Array(W(e,n))},t.wbg.__wbg_new_no_args_cb138f77cf6151ee=function(e,n){return new Function(u(e,n))},t.wbg.__wbg_new_with_byte_offset_and_length_d85c3da1fd8df149=function(e,n,r){return new Uint8Array(e,n>>>0,r>>>0)},t.wbg.__wbg_new_with_str_and_init_c5748f76f5108934=function(){return d(function(e,n,r){return new Request(u(e,n),r)},arguments)},t.wbg.__wbg_next_138a17bbf04e926c=function(e){return e.next},t.wbg.__wbg_next_3cfe5c0fe2a4cc53=function(){return d(function(e){return e.next()},arguments)},t.wbg.__wbg_now_2c95c9de01293173=function(e){return e.now()},t.wbg.__wbg_performance_7a3ffd0b17f663ad=function(e){return e.performance},t.wbg.__wbg_prototypesetcall_dfe9b766cdc1f1fd=function(e,n,r){Uint8Array.prototype.set.call(W(e,n),r)},t.wbg.__wbg_queueMicrotask_6808622725a52272=function(e){return e.queueMicrotask},t.wbg.__wbg_queueMicrotask_ef0e86b0263a71ee=function(e){queueMicrotask(e)},t.wbg.__wbg_read_39c4b35efcd03c25=function(e){return e.read()},t.wbg.__wbg_releaseLock_a5912f590b185180=function(e){e.releaseLock()},t.wbg.__wbg_resolve_fd5bfbaa4ce36e1e=function(e){return Promise.resolve(e)},t.wbg.__wbg_respond_9f7fc54636c4a3af=function(){return d(function(e,n){e.respond(n>>>0)},arguments)},t.wbg.__wbg_set_169e13b608078b7b=function(e,n,r){e.set(W(n,r))},t.wbg.__wbg_set_body_8e743242d6076a4f=function(e,n){e.body=n},t.wbg.__wbg_set_credentials_55ae7c3c106fd5be=function(e,n){e.credentials=ce[n]},t.wbg.__wbg_set_headers_5671cf088e114d2b=function(e,n){e.headers=n},t.wbg.__wbg_set_method_76c69e41b3570627=function(e,n,r){e.method=u(n,r)},t.wbg.__wbg_set_mode_611016a6818fc690=function(e,n){e.mode=ae[n]},t.wbg.__wbg_set_signal_e89be862d0091009=function(e,n){e.signal=n},t.wbg.__wbg_signal_3c14fbdc89694b39=function(e){return e.signal},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,n){const r=n.stack,o=k(r,s.__wbindgen_malloc,s.__wbindgen_realloc),i=m;l().setInt32(e+4*1,i,!0),l().setInt32(e+4*0,o,!0)},t.wbg.__wbg_static_accessor_GLOBAL_769e6b65d6557335=function(){const e=typeof global>"u"?null:global;return b(e)?0:f(e)},t.wbg.__wbg_static_accessor_GLOBAL_THIS_60cf02db4de8e1c1=function(){const e=typeof globalThis>"u"?null:globalThis;return b(e)?0:f(e)},t.wbg.__wbg_static_accessor_SELF_08f5a74c69739274=function(){const e=typeof self>"u"?null:self;return b(e)?0:f(e)},t.wbg.__wbg_static_accessor_WINDOW_a8924b26aa92d024=function(){const e=typeof window>"u"?null:window;return b(e)?0:f(e)},t.wbg.__wbg_status_9bfc680efca4bdfd=function(e){return e.status},t.wbg.__wbg_stringify_655a6390e1f5eb6b=function(){return d(function(e){return JSON.stringify(e)},arguments)},t.wbg.__wbg_then_429f7caf1026411d=function(e,n,r){return e.then(n,r)},t.wbg.__wbg_then_4f95312d68691235=function(e,n){return e.then(n)},t.wbg.__wbg_url_b6d11838a4f95198=function(e,n){const r=n.url,o=k(r,s.__wbindgen_malloc,s.__wbindgen_realloc),i=m;l().setInt32(e+4*1,i,!0),l().setInt32(e+4*0,o,!0)},t.wbg.__wbg_value_57b7b035e117f7ee=function(e){return e.value},t.wbg.__wbg_value_70f40a4190152b70=function(e){return e.value},t.wbg.__wbg_view_788aaf149deefd2f=function(e){const n=e.view;return b(n)?0:f(n)},t.wbg.__wbg_warn_6e567d0d926ff881=function(e){console.warn(e)},t.wbg.__wbindgen_cast_2241b6af4c4b2941=function(e,n){return u(e,n)},t.wbg.__wbindgen_cast_4625c577ab2ec9ee=function(e){return BigInt.asUintN(64,e)},t.wbg.__wbindgen_cast_9e233e011226ce50=function(e,n){return re(e,n,s.wasm_bindgen__closure__destroy__hfc9609cee39e6e81,se)},t.wbg.__wbindgen_init_externref_table=function(){const e=s.__wbindgen_externrefs,n=e.grow(4);e.set(0,void 0),e.set(n+0,void 0),e.set(n+1,null),e.set(n+2,!0),e.set(n+3,!1)},t}function de(t,e){return s=t.exports,D.__wbindgen_wasm_module=e,S=null,F=null,v=null,s.__wbindgen_start(),s}async function D(t){if(s!==void 0)return s;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("/15m/assets/backend_bg-721f55ff.wasm",self.location));const e=be();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:r}=await ue(await t,e);return de(n,r)}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const G=Symbol("Comlink.proxy"),ge=Symbol("Comlink.endpoint"),we=Symbol("Comlink.releaseProxy"),U=Symbol("Comlink.finalizer"),I=Symbol("Comlink.thrown"),Y=t=>typeof t=="object"&&t!==null||typeof t=="function",le={canHandle:t=>Y(t)&&t[G],serialize(t){const{port1:e,port2:n}=new MessageChannel;return J(t,e),[n,[n]]},deserialize(t){return t.start(),pe(t)}},ye={canHandle:t=>Y(t)&&I in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},Z=new Map([["proxy",le],["throw",ye]]);function me(t,e){for(const n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function J(t,e=globalThis,n=["*"]){e.addEventListener("message",function r(o){if(!o||!o.data)return;if(!me(n,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}const{id:i,type:_,path:c}=Object.assign({path:[]},o.data),a=(o.data.argumentList||[]).map(R);let g;try{const w=c.slice(0,-1).reduce((y,B)=>y[B],t),p=c.reduce((y,B)=>y[B],t);switch(_){case"GET":g=p;break;case"SET":w[c.slice(-1)[0]]=R(o.data.value),g=!0;break;case"APPLY":g=p.apply(w,a);break;case"CONSTRUCT":{const y=new p(...a);g=xe(y)}break;case"ENDPOINT":{const{port1:y,port2:B}=new MessageChannel;J(t,B),g=Re(y,[y])}break;case"RELEASE":g=void 0;break;default:return}}catch(w){g={value:w,[I]:0}}Promise.resolve(g).catch(w=>({value:w,[I]:0})).then(w=>{const[p,y]=z(w);e.postMessage(Object.assign(Object.assign({},p),{id:i}),y),_==="RELEASE"&&(e.removeEventListener("message",r),X(e),U in t&&typeof t[U]=="function"&&t[U]())}).catch(w=>{const[p,y]=z({value:new TypeError("Unserializable return value"),[I]:0});e.postMessage(Object.assign(Object.assign({},p),{id:i}),y)})}),e.start&&e.start()}function he(t){return t.constructor.name==="MessagePort"}function X(t){he(t)&&t.close()}function pe(t,e){return H(t,[],e)}function L(t){if(t)throw new Error("Proxy has been released and is not useable")}function K(t){return O(t,{type:"RELEASE"}).then(()=>{X(t)})}const N=new WeakMap,P="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(N.get(t)||0)-1;N.set(t,e),e===0&&K(t)});function Ee(t,e){const n=(N.get(e)||0)+1;N.set(e,n),P&&P.register(t,e,t)}function Ae(t){P&&P.unregister(t)}function H(t,e=[],n=function(){}){let r=!1;const o=new Proxy(n,{get(i,_){if(L(r),_===we)return()=>{Ae(o),K(t),r=!0};if(_==="then"){if(e.length===0)return{then:()=>o};const c=O(t,{type:"GET",path:e.map(a=>a.toString())}).then(R);return c.then.bind(c)}return H(t,[...e,_])},set(i,_,c){L(r);const[a,g]=z(c);return O(t,{type:"SET",path:[...e,_].map(w=>w.toString()),value:a},g).then(R)},apply(i,_,c){L(r);const a=e[e.length-1];if(a===ge)return O(t,{type:"ENDPOINT"}).then(R);if(a==="bind")return H(t,e.slice(0,-1));const[g,w]=Q(c);return O(t,{type:"APPLY",path:e.map(p=>p.toString()),argumentList:g},w).then(R)},construct(i,_){L(r);const[c,a]=Q(_);return O(t,{type:"CONSTRUCT",path:e.map(g=>g.toString()),argumentList:c},a).then(R)}});return Ee(o,t),o}function Se(t){return Array.prototype.concat.apply([],t)}function Q(t){const e=t.map(z);return[e.map(n=>n[0]),Se(e.map(n=>n[1]))]}const q=new WeakMap;function Re(t,e){return q.set(t,e),t}function xe(t){return Object.assign(t,{[G]:!0})}function z(t){for(const[e,n]of Z)if(n.canHandle(t)){const[r,o]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},o]}return[{type:"RAW",value:t},q.get(t)||[]]}function R(t){switch(t.type){case"HANDLER":return Z.get(t.name).deserialize(t.value);case"RAW":return t.value}}function O(t,e,n){return new Promise(r=>{const o=ke();t.addEventListener("message",function i(_){!_.data||!_.data.id||_.data.id!==o||(t.removeEventListener("message",i),r(_.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),n)})}function ke(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class Oe{constructor(){ee(this,"inner");this.inner=null}async loadOsmFile(e,n,r,o){await D(),this.inner=await new A(e,n,r,o)}async loadModelFile(e){await D(),this.inner=await A.loadFile(e)}isLoaded(){return this.inner!=null}unset(){this.inner=null}getBounds(){if(!this.inner)throw new Error("Backend used without a file loaded");return Array.from(this.inner.getBounds())}getInvertedBoundary(){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.getInvertedBoundary())}renderDebug(){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.renderDebug())}renderAmenities(){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.renderAmenities())}renderZones(){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.renderZones())}isochrone(e){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.isochrone({x:e.start.lng,y:e.start.lat,from_amenities:[],profile:e.profile=="transit"?"foot":e.profile,transit:e.profile=="transit",style:e.style,start_time:e.startTime,max_seconds:e.maxSeconds}))}isochroneFromAmenities(e){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.isochrone({x:0,y:0,from_amenities:e.fromAmenities,profile:e.profile=="transit"?"foot":e.profile,transit:e.profile=="transit",style:e.style,start_time:e.startTime,max_seconds:e.maxSeconds}))}route(e){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.route({x1:e.start.lng,y1:e.start.lat,x2:e.end[0],y2:e.end[1],profile:e.profile=="transit"?"foot":e.profile,transit:e.profile=="transit",debug_search:e.debugSearch,use_heuristic:e.useHeuristic,start_time:e.startTime}))}bufferRoute(e){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.bufferRoute({x1:e.start.lng,y1:e.start.lat,x2:e.end[0],y2:e.end[1],profile:e.profile=="transit"?"foot":e.profile,transit:e.profile=="transit",use_heuristic:e.useHeuristic,start_time:e.startTime,max_seconds:e.maxSeconds}))}score(e,n){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.score({profile:e.profile,poi_kinds:e.poiKinds,max_seconds:e.maxSeconds},n))}snapAndBufferRoute(e,n){if(!this.inner)throw new Error("Backend used without a file loaded");return JSON.parse(this.inner.snapAndBufferRoute({input:JSON.stringify(e.input),profile:e.profile,start_time:e.startTime,max_seconds:e.maxSeconds},n))}}J(Oe)})();
